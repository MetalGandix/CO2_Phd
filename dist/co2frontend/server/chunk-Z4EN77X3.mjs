import './polyfills.server.mjs';
import{j as w,k as y,o as T,p as R}from"./chunk-AP7OQGCV.mjs";import{$a as r,Aa as x,Ea as g,Na as m,Ob as v,Pa as t,Qa as i,Qb as S,Ra as b,Va as _,Wa as c,ab as M,ac as L,bb as C,bc as I,cb as p,cc as P,db as f,dc as E,eb as u,ec as O,fc as k,nc as N,oc as z,sa as l,ta as d}from"./chunk-B4AJPWR3.mjs";import"./chunk-S6KH3LOX.mjs";function W(o,a){if(o&1&&(t(0,"div",10),r(1),i()),o&2){let e=c();l(),C(" ",e.errorMessage,`
`)}}function D(o,a){if(o&1&&(t(0,"p",10),r(1),i()),o&2){let e=c();l(),M(e.errorMessage)}}function j(o,a){o&1&&(t(0,"div",11),b(1,"div",12),i())}var A=class o{constructor(a,e,n){this.authService=a;this.router=e;this.errorService=n}email="";password="";errorMessage="";isLoading=!1;ngOnInit(){this.errorMessage=this.errorService.getErrorMessage(),this.errorService.clearErrorMessage()}onLogin(){if(!this.email||!this.password){this.errorMessage="Per favore, compila tutti i campi.";return}this.isLoading=!0;let a={email:this.email,password:this.password};this.authService.login(a).subscribe({next:e=>{console.log("Login successful:",e),sessionStorage.setItem("authToken",e.token),sessionStorage.setItem("userId",e.userId),sessionStorage.setItem("role",e.role),sessionStorage.setItem("email",this.email),this.errorMessage="",this.isLoading=!1,this.router.navigate(["/co2-input"]).then(()=>{window.location.reload()})},error:e=>{console.error("Errore durante il login:",e),this.errorMessage="Credenziali non valide. Riprova.",this.isLoading=!1}})}static \u0275fac=function(e){return new(e||o)(d(T),d(w),d(R))};static \u0275cmp=x({type:o,selectors:[["app-login"]],decls:19,vars:5,consts:[["class","error-message",4,"ngIf"],[1,"form-container"],[3,"ngSubmit"],["for","email"],["type","email","id","email","name","email","placeholder","Inserisci email","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","placeholder","Inserisci password","required","",3,"ngModelChange","ngModel"],["type","submit"],["class","spinner-container",4,"ngIf"],["routerLink","/register",2,"color","#1b5e20","text-decoration","none"],[1,"error-message"],[1,"spinner-container"],[1,"spinner"]],template:function(e,n){e&1&&(g(0,W,2,1,"div",0),t(1,"div",1)(2,"h2"),r(3,"Login"),i(),t(4,"form",2),_("ngSubmit",function(){return n.onLogin()}),t(5,"label",3),r(6,"Email:"),i(),t(7,"input",4),u("ngModelChange",function(s){return f(n.email,s)||(n.email=s),s}),i(),t(8,"label",5),r(9,"Password:"),i(),t(10,"input",6),u("ngModelChange",function(s){return f(n.password,s)||(n.password=s),s}),i(),t(11,"button",7),r(12,"Accedi"),i(),g(13,D,2,1,"p",0)(14,j,2,0,"div",8),i(),t(15,"p"),r(16," Non hai un account? "),t(17,"a",9),r(18," Registrati "),i()()()),e&2&&(m("ngIf",n.errorMessage),l(7),p("ngModel",n.email),l(3),p("ngModel",n.password),l(3),m("ngIf",n.errorMessage),l(),m("ngIf",n.isLoading))},dependencies:[S,v,z,k,L,I,P,N,O,E,y],styles:[".form-container[_ngcontent-%COMP%]{width:50%;margin:50px auto;padding:20px;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 10px #0003;background:linear-gradient(to bottom,#e8f5e9,#c8e6c9);font-family:Arial,sans-serif}.error-message[_ngcontent-%COMP%]{color:red;font-weight:700;margin-bottom:10px}h2[_ngcontent-%COMP%]{text-align:center;font-size:1.8rem;color:#2e7d32;margin-bottom:20px}.error-message[_ngcontent-%COMP%]{color:red;margin-top:10px;font-size:.9rem;text-align:center}label[_ngcontent-%COMP%]{display:block;margin:10px 0 5px;font-weight:700;color:#388e3c}input[_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:15px;border:1px solid #ccc;border-radius:4px;background-color:#f1f8e9;font-size:1rem;box-sizing:border-box}button[_ngcontent-%COMP%]{width:100%;padding:12px;background-color:#4caf50;color:#fff;border:none;border-radius:4px;font-size:1.1rem;cursor:pointer;font-weight:700;transition:background-color .3s,transform .2s}button[_ngcontent-%COMP%]:hover{background-color:#388e3c;transform:scale(1.05)}p[_ngcontent-%COMP%]{text-align:center;color:#2e7d32;font-size:.9rem}.nature-icon[_ngcontent-%COMP%]{display:block;margin:0 auto 20px;width:80px;height:80px}.spinner-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #fff;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};export{A as LoginComponent};
